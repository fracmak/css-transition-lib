/*! css-transition-lib - v0.0.1 - 2014-09-08
* https://github.com/fracmak/css-transition-lib
* Copyright (c) 2014 Jay Merrifield; Licensed MIT */
!function(a){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(b){window.CSSAnimate=a(b)}):window.CSSAnimate=a(window.jQuery||window.Zepto||window.$)}(function(a){"use strict";function b(a){var b,c=document.createElement("p").style,d=["ms","O","Moz","Webkit"];if(""===c[a])return a;for(a=a.charAt(0).toUpperCase()+a.slice(1),b=d.length;b--;)if(""===c[d[b]+a])return d[b]+a}function c(a){var b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};return b[a]}var d=function(a){this.transitionCssName=a,this.transitionEndName=c(a)};return d.prototype={animate:function(b,c,d,e,f,g){var h=this;return b=a(b),0===b.length?(console.error("tried animating null or empty jquery object"),a.Deferred().reject()):a.when.apply(a,a.map(b,function(b){return h.transitionCssName?h.cssTransition(a(b),c,d,e,f,g):h.jQuery(a(b),c,d,e,f,g)}))},cssTransition:function(b,c,d,e,f,g){var h;return"opacity"===c&&"none"===b.css("display")&&(e=0),this._isDocumentHidden()?(b.css(c,d),a.Deferred().resolve()):(0!==e&&40>e&&(e=40),f=this._normalizeEasing(f,!1),h=a.camelCase(c),d=this._getCssNumber(h,d),g=g?" "+g+"ms":"",this._transition(b,c,h,d,e,f,g))},jQuery:function(b,c,d,e,f,g){if(this._isDocumentHidden())return b.css(c,d),a.Deferred().resolve();var h={};return f=this._normalizeEasing(f,!0),h[c]=d,a.Deferred(function(a){var i="proganimate"+c;b.stop(i,!0),0===e?(b.css(c,d),setTimeout(function(){a.resolve()},1)):b.delay(g||0).animate(h,{duration:e,easing:f,queue:i,done:function(){b.css(c,d),a.resolve()},fail:function(){a.reject()}}).dequeue(i)}).promise()},stop:function(b,c){var d=a.camelCase(c),e=window.getComputedStyle(b[0]).getPropertyValue(c);return b.stop("proganimate"+c,!0),this._failPreviousTransition(b,d)&&(b[0].style[d]=e),e},_easingMap:{easeInQuad:"ease-in",easeInSine:"ease-in",easeInCubic:"ease-in",easeInQuart:"ease-in",easeInQuint:"ease-in",easeInExpo:"ease-in",easeInCirc:"ease-in",easeInBack:"ease-in",easeInElastic:"ease-in",easeInBounce:"ease-in",easeOutQuad:"ease-out",easeOutSine:"ease-out",easeOutCubic:"ease-out",easeOutQuart:"ease-out",easeOutQuint:"ease-out",easeOutExpo:"ease-out",easeOutCirc:"ease-out",easeOutBack:"ease-out",easeOutElastic:"ease-out",easeOutBounce:"ease-out",easeInOutQuad:"ease-in-out",easeInOutSine:"ease-in-out",easeInOutCubic:"ease-in-out",easeInOutQuart:"ease-in-out",easeInOutQuint:"ease-in-out",easeInOutExpo:"ease-in-out",easeInOutCirc:"ease-in-out",easeInOutBack:"ease-in-out",easeInOutElastic:"ease-in-out",easeInOutBounce:"ease-in-out",swing:"ease-in-out"},_normalizeEasing:function(a,b){var c,d=this._easingMap;return a=a||"linear",b&&(d=this._invert(d)),c=d[a],c?a=c:-1!==a.indexOf("cubic-bezier")?b&&(a="swing"):this._easingMap[a]||(a="linear"),a},_transition:function(b,c,d,e,f,g,h){var i,j=a.Deferred(),k=this._getCurrentValue(b,d,c);return this._shouldDoTransition(b,d,c,k,e,f)?(i=c+" "+f+"ms "+g+" "+h,j=this._doTransition(b,d,c,e,i)):setTimeout(function(){j.resolve()},1),j.promise()},_doTransition:function(b,c,d,e,f){var g=b[0].style,h=this;return this._getAnimationDeferred(b,c,d,"2d",function(a){h._triggerTransition(a,b,c,d,e,f)}).then(function(){return e.replace(/[ ]+/g,"")===g[c].replace(/[ ]+/g,"")?a.Deferred().resolve():a.Deferred().reject()})},_getAnimationDeferred:function(b,c,d,e,f){var g=this;return a.Deferred(function(a){var h=g._failPreviousTransition(b,c,!0);setTimeout(function(){h&&h.cleanup(),"pending"===a.state()&&f(a)},20),b.data("transition-animate-"+c+"-defer",{promise:a,animationType:e,cleanup:function(){g._removeTransition(b[0].style,d)}})}).always(function(a){b.removeData("transition-animate-"+c+"-defer"),a||g._removeTransition(b[0].style,d)})},_removeTransition:function(b,c){var d=b[this.transitionCssName];d=d||"",d=d.replace(new RegExp(c+" \\w+ [\\w-]+(\\s*\\([^\\)]*\\))?"),""),b[this.transitionCssName]=a.trim(d.replace(/^[ ,]+/,"").replace(/[ ,]+$/,"").replace(/,[ ]+,/,""))},_triggerTransition:function(a,b,c,d,e,f){var g=b[0].style;this._registerTransitionEndListener(b,a,d),this._setupTransition(g,d,f),g[c]=e},_failPreviousTransition:function(a,b,c){var d=a.data("transition-animate-"+b+"-defer");return d?(d.promise.reject(c),d):void 0},_setupTransition:function(a,b,c){var d=a[this.transitionCssName];d?d+=","+c:d=c,a[this.transitionCssName]=d},_getCurrentValue:function(a,b,c){var d=a[0].style,e=d[b]||a.css(c);return"auto"!==e&&e||(d[b]=this._getCssNumber(b,0),e="0"),e},_shouldDoTransition:function(a,b,c,d,e,f){var g=a[0].style;return 0===f?(this._failPreviousTransition(a,b),g[b]=e,!1):this._canAnimate(d,e)?d:(this._failPreviousTransition(a,b),!1)},_canAnimate:function(a,b){return"0"===a.replace(/[ a-z%]+/g,"")&&"0"===b.replace(/[ a-z%]+/g,"")?!1:a.replace(/[ ]/g,"")!==b.replace(/[ ]/g,"")},_getCssNumber:function(b,c){return a.cssNumber[b]||!this._isNumber(c)&&c.match(/[a-z%]/)?c+"":c+"px"},_registerTransitionEndListener:function(b,c,d){if(this.transitionEndName){var e=b[0],f=this.transitionEndName,g=function(a){a.target!==e||d&&a.propertyName!==d||(this.removeEventListener(f,g),c.resolve(),g=null)};return e.addEventListener(f,g),c.promise()}return a.Deferred.reject()},_invert:function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b},_isNumber:function(a){return"[object Number]"===Object.prototype.toString.call(a)},_isDocumentHidden:function(){return document.hidden||document.webkitHidden||document.mozHidden||document.msHidden||document.oHidden}},new d(b("transition"))});